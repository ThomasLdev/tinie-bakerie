# JoliCode Media Bundle Configuration
joli_media:
    default_library: default

    # Configure WebP processors for optimal image conversion
    processors:
        cwebp:
            options:
                near_lossless:
                    quality: 60  # Higher quality for near-lossless WebP
                    method: 6    # Best compression method
                lossy:
                    quality: 85  # Good balance between quality and size
        imagine:
            options:
                jpeg_quality: 85
                png_quality: 85

    # Pre-processors run before any transformation
    pre_processors:
        - JoliCode\MediaBundle\PreProcessor\ExifRemovalPreProcessor

    # Media library configuration
    libraries:
        default:
            # Original media storage
            original:
                flysystem: "filesystem.original.storage"
                url_generator:
                    strategy: folder
                    path: /media/original/

            # Cache for processed variations
            cache:
                flysystem: "filesystem.cache.storage"
                must_store_when_generating_url: true  # Generate variations immediately
                url_generator:
                    strategy: folder
                    path: /media/cache/

            # Enable automatic WebP conversion for all variations
            enable_auto_webp: true

            # Support for retina displays (1x and 2x)
            pixel_ratios: [1, 2]

            # Define image variations/transformations
            variations:
                # Thumbnail for admin lists (square, cropped)
                thumbnail:
                    transformers:
                        - { type: thumbnail, width: 150, height: 150, crop_position: center }

                # Small image for cards/grids (fit inside width)
                small:
                    transformers:
                        - { type: resize, width: 400, height: 400, mode: inside }

                # Medium image for content (fit inside width)
                medium:
                    transformers:
                        - { type: resize, width: 800, height: 800, mode: inside }

                # Large image for hero sections (fit inside width)
                large:
                    transformers:
                        - { type: resize, width: 1200, height: 1200, mode: inside }

                # Full HD for high-res displays (fit inside width)
                xlarge:
                    transformers:
                        - { type: resize, width: 1920, height: 1920, mode: inside }
