{# 
  Custom EasyAdmin Form Theme
  Adds data-test-id attributes to all form elements in dev/test environments only.
  Production builds will have zero test attributes.
#}
{% extends '@EasyAdmin/crud/form_theme.html.twig' %}

{# Input fields (text, number, email, etc.) #}
{% block form_widget_simple -%}
    {%- set attr = attr|merge(app.environment != 'prod' ? {
        'data-test-id': name|replace({'[': '-', ']': ''})|lower
    } : {}) -%}
    {{- parent() -}}
{%- endblock form_widget_simple %}

{# Select dropdowns #}
{% block choice_widget_collapsed -%}
    {%- set attr = attr|merge(app.environment != 'prod' ? {
        'data-test-id': name|replace({'[': '-', ']': ''})|lower
    } : {}) -%}
    {{- parent() -}}
{%- endblock choice_widget_collapsed %}

{# Textareas #}
{% block textarea_widget -%}
    {%- set attr = attr|merge(app.environment != 'prod' ? {
        'data-test-id': name|replace({'[': '-', ']': ''})|lower
    } : {}) -%}
    {{- parent() -}}
{%- endblock textarea_widget %}

{# Checkboxes #}
{% block checkbox_widget -%}
    {%- set attr = attr|merge(app.environment != 'prod' ? {
        'data-test-id': name|replace({'[': '-', ']': ''})|lower
    } : {}) -%}
    {{- parent() -}}
{%- endblock checkbox_widget %}

{# Collection fields (for media, sections, etc.) #}
{% block ea_crud_widget_collection -%}
    {%- if app.environment != 'prod' -%}
        {%- set attr = attr|merge({'data-test-id': name ~ '-collection'}) -%}
    {%- endif -%}
    {{- parent() -}}
{%- endblock ea_crud_widget_collection %}

{# File upload fields #}
{% block vich_file_widget -%}
    {%- if app.environment != 'prod' -%}
        {%- set attr = attr|merge({'data-test-id': name|replace({'[': '-', ']': ''})|lower ~ '-file'}) -%}
    {%- endif -%}
    {{- parent() -}}
{%- endblock vich_file_widget %}
